<h1>🛠️ 程式碼維護與註解</h1>
<p>此頁籤包含此工具的完整原始碼，方便您未來進行檢視、修改或維護。</p>

<h2>程式碼結構</h2>
<p>這是一個單一 HTML 檔案應用，結構如下：</p>
<ul>
    <li><code>&lt;head&gt;</code>：
        <ul>
            <li>引入外部 <code>xlsx.full.min.js</code> 函式庫，這是讀取 Excel 檔案的核心。</li>
            <li><code>&lt;style&gt;</code> 標籤：包含所有的 CSS 樣式。</li>
        </ul>
    </li>
    <li><code>&lt;body&gt;</code>：
        <ul>
            <li>HTML 結構：定義了上傳區域、控制面板、表格顯示區域等所有介面元素。</li>
            <li><code>&lt;script&gt;</code> 標籤：
                <ul>
                    <li>使用 IIFE (Immediately Invoked Function Expression) 模式，將所有程式碼封裝在 <code>ExcelViewer</code> 物件中，避免污染全域變數。</li>
                    <li><code>ExcelViewer.init()</code>：程式的進入點，負責綁定所有事件監聽器。</li>
                    <li><strong>狀態管理</strong>：使用 <code>state</code> 物件來追蹤目前狀態（如是否處理中、載入的檔案列表等）。</li>
                    <li><strong>DOM 快取</strong>：使用 <code>cacheElements()</code> 函數在啟動時快取所有需要操作的 DOM 元素，提升效能。</li>
                    <li><strong>主要邏輯</strong>：
                        <ul>
                            <li><code>processFiles()</code>: 處理檔案上傳、驗證、讀取和解析的核心非同步函數。</li>
                            <li><code>renderTables()</code>: 將解析後的 HTML 表格渲染到頁面上，並呼叫 <code>injectCheckboxes()</code> 來插入勾選框。</li>
                            <li><code>filterTable()</code>: 處理即時搜尋邏輯。</li>
                            <li><code>selectByKeyword()</code> / <code>selectEmptyRows()</code> 等：處理各種資料列勾選邏輯。</li>
                            <li><code>exportHtml()</code> / <code>exportXlsx()</code> / <code>exportMergedXlsx()</code>: 處理不同類型的匯出邏輯。</li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
    </li>
</ul>

<h2>完整原始碼</h2>
<p>完整的原始碼已被拆分到 <code>app/</code> 資料夾下的 <code>index.html</code>, <code>style.css</code>, 和 <code>script.js</code> 中，以便於維護。</p>