<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel æª¢è¦–å™¨èˆ‡èªªæ˜æ–‡ä»¶</title>
    <style>
        /* --- é ç±¤ç³»çµ±æ¨£å¼ --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            background-color: #f4f7f6;
            color: #333;
        }
        .tab-container {
            max-width: 1600px;
            margin: 15px auto;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            background-color: #ffffff;
        }
        .tab-nav {
            display: flex;
            background-color: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
            padding: 0 10px;
        }
        .tab-btn {
            padding: 14px 22px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            background: none;
            cursor: pointer;
            color: #495057;
            position: relative;
            top: 2px;
            border-bottom: 3px solid transparent;
            transition: color 0.2s ease, border-color 0.2s ease;
        }
        .tab-btn:hover {
            color: #0056b3;
        }
        .tab-btn.active {
            color: #667eea; /* ä¸»é¡Œè‰² */
            border-bottom-color: #667eea;
        }
        .tab-content {
            background-color: #ffffff;
        }
        .tab-pane {
            display: none;
        }
        .tab-pane.active {
            display: block;
        }
        
        /* --- èªªæ˜æ–‡ä»¶é é¢æ¨£å¼ --- */
        .doc-page {
            padding: 25px 35px;
            line-height: 1.7;
            color: #212529;
            /* è®“èªªæ˜é é¢åœ¨åˆ‡æ›æ™‚ä¹Ÿèƒ½æ»¾å‹• */
            max-height: calc(100vh - 120px);
            overflow-y: auto;
        }
        .doc-page h1 {
            color: #667eea;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
            margin-top: 0;
        }
        .doc-page h2 {
            color: #495057;
            margin-top: 30px;
            border-left: 4px solid #764ba2;
            padding-left: 10px;
        }
        .doc-page code {
            background-color: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
            font-size: 0.9em;
        }
        .doc-page ul {
            padding-left: 20px;
        }
        .doc-page li {
            margin-bottom: 8px;
        }

        /* --- æ‡‰ç”¨ç¨‹å¼é ç±¤æ¨£å¼ --- */
        #tab-app-pane {
            padding: 0;
            /* è®“ iframe å¡«æ»¿å¯ç”¨ç©ºé–“ */
            height: calc(100vh - 80px); 
            overflow: hidden;
        }
        #app-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* --- ç¨‹å¼ç¢¼ç¶­è­·é ç±¤æ¨£å¼ --- */
        #tab-code-pane pre {
            background-color: #2b2b2b;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            /* è¨­å®šæœ€å¤§é«˜åº¦ä¸¦å…è¨±æ»¾å‹• */
            max-height: calc(100vh - 120px); 
        }
        #tab-code-pane code {
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            background: none;
            padding: 0;
            color: inherit;
        }
    </style>
</head>
<body>

    <div class="tab-container">
        <nav class="tab-nav">
            <button class="tab-btn" data-tab="tab-guide-pane">ğŸ“– ä½¿ç”¨èªªæ˜</button>
            <button class="tab-btn active" data-tab="tab-app-pane">ğŸš€ Excel æª¢è¦–å™¨</button>
            <button class="tab-btn" data-tab="tab-code-pane">ğŸ› ï¸ ç¨‹å¼ç¢¼ç¶­è­·</button>
        </nav>

        <main class="tab-content">
            <section id="tab-guide-pane" class="tab-pane doc-page">
                <h1>ğŸ“– Excel æª¢è¦–å™¨ - ä½¿ç”¨èªªæ˜</h1>
                <p>æœ¬å·¥å…·æ˜¯ä¸€å€‹å¼·å¤§çš„å‰ç«¯ Excel æª”æ¡ˆæª¢è¦–å™¨ï¼Œå°ˆç‚ºå¿«é€Ÿæ•´åˆã€ç¯©é¸å’ŒåŒ¯å‡ºå¤šå€‹ Excel æª”æ¡ˆæˆ–å·¥ä½œè¡¨è€Œè¨­è¨ˆã€‚æ‰€æœ‰æ“ä½œå‡åœ¨æ‚¨çš„ç€è¦½å™¨æœ¬æ©Ÿå®Œæˆï¼Œè³‡æ–™ä¸æœƒä¸Šå‚³åˆ°ä»»ä½•ä¼ºæœå™¨ï¼Œç¢ºä¿è³‡æ–™å®‰å…¨ã€‚</p>

                <h2>ä¸»è¦åŠŸèƒ½</h2>
                <ul>
                    <li>æ”¯æ´æ‹–æ”¾æˆ–é»æ“Šä¸Šå‚³ <code>.xls</code> å’Œ <code>.xlsx</code> æª”æ¡ˆã€‚</li>
                    <li>å¯ä¸€æ¬¡è¼‰å…¥å¤šå€‹æª”æ¡ˆï¼Œä¸¦è‡ªè¨‚è¦åŒ¯å…¥çš„å·¥ä½œè¡¨ã€‚</li>
                    <li>æä¾›ã€Œåˆ—è¡¨ã€å’Œã€Œç¶²æ ¼ã€å…©ç¨®æª¢è¦–æ¨¡å¼ã€‚</li>
                    <li>å¼·å¤§çš„è³‡æ–™åˆ—æ“ä½œï¼šå³æ™‚æœå°‹ã€é—œéµå­—å‹¾é¸ã€åˆªé™¤ã€åé¸ç­‰ã€‚</li>
                    <li>æ”¯æ´å¤šç¨®åŒ¯å‡ºæ ¼å¼ï¼šHTMLã€XLSXï¼ˆå¯é¸æ“‡å…¨éƒ¨ã€åƒ…é¸å–ï¼Œæˆ–åˆä½µç‚ºå–®ä¸€æª”æ¡ˆï¼‰ã€‚</li>
                </ul>

                <h2>æ“ä½œæ­¥é©Ÿ</h2>

                <h3>1. é¸æ“‡åŒ¯å…¥æ–¹å¼</h3>
                <p>åœ¨ã€Œæ­¥é©Ÿä¸€ã€ä¸­ï¼Œæ‚¨å¯ä»¥æ±ºå®šå¦‚ä½•å¾ Excel æª”æ¡ˆï¼ˆç‰¹åˆ¥æ˜¯æ“æœ‰å¤šå€‹å·¥ä½œè¡¨çš„æª”æ¡ˆï¼‰ä¸­è®€å–è³‡æ–™ï¼š</p>
                <ul>
                    <li><strong>åŒ¯å…¥æ‰€æœ‰å·¥ä½œè¡¨</strong>ï¼šè®€å–æ¯å€‹æª”æ¡ˆä¸­çš„æ‰€æœ‰å·¥ä½œè¡¨ã€‚</li>
                    <li><strong>åƒ…åŒ¯å…¥ç¬¬ä¸€å¼µå·¥ä½œè¡¨</strong>ï¼šé è¨­é¸é …ï¼Œåªè®€å–æ¯å€‹æª”æ¡ˆçš„ç¬¬ä¸€å€‹å·¥ä½œè¡¨ã€‚</li>
                    <li><strong>åŒ¯å…¥æŒ‡å®šä½ç½®</strong>ï¼šè®€å–ç‰¹å®šä½ç½®çš„å·¥ä½œè¡¨ã€‚ä¾‹å¦‚è¼¸å…¥ <code>1</code>ï¼ˆç¬¬ä¸€å¼µï¼‰ã€<code>1, 3</code>ï¼ˆç¬¬ä¸€å’Œç¬¬ä¸‰å¼µï¼‰ã€<code>2-4</code>ï¼ˆç¬¬äºŒåˆ°ç¬¬å››å¼µï¼‰ã€‚</li>
                    <li><strong>åŒ¯å…¥æŒ‡å®šåç¨±</strong>ï¼šè®€å–åç¨±ä¸­åŒ…å«æ‚¨è¼¸å…¥é—œéµå­—çš„å·¥ä½œè¡¨ã€‚</li>
                    <li><strong>é€ä¸€æª”æ¡ˆæ‰‹å‹•æ±ºå®š</strong>ï¼šä¸Šå‚³æª”æ¡ˆå¾Œï¼Œå·¥å…·æœƒå½ˆå‡ºè¦–çª—ï¼Œè®“æ‚¨æ‰‹å‹•å‹¾é¸æ¯å€‹æª”æ¡ˆè¦åŒ¯å…¥çš„å·¥ä½œè¡¨ã€‚</li>
                </ul>

                <h3>2. ä¸Šå‚³æª”æ¡ˆ</h3>
                <p>åœ¨ã€Œæ­¥é©ŸäºŒã€ä¸­ï¼Œæ‚¨å¯ä»¥é€éä»¥ä¸‹ä»»ä¸€æ–¹å¼ä¸Šå‚³æª”æ¡ˆï¼š</p>
                <ul>
                    <li>å°‡ä¸€å€‹æˆ–å¤šå€‹ Excel æª”æ¡ˆæ‹–æ”¾åˆ°è™›ç·šæ¡†å€åŸŸã€‚</li>
                    <li>é»æ“Šã€Œé¸æ“‡ Excel æª”æ¡ˆã€æŒ‰éˆ•ä¾†é¸å–æª”æ¡ˆã€‚</li>
                </ul>
                <p>è¼‰å…¥å¾Œï¼Œæ‚¨å¯ä»¥éš¨æ™‚é»æ“Šã€ŒğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰æª”æ¡ˆã€ä¾†é‡ç½®å·¥å…·ã€‚</p>

                <h3>3. æª¢è¦–èˆ‡æ“ä½œ</h3>
                <p>æª”æ¡ˆè¼‰å…¥å¾Œï¼Œæœƒé¡¯ç¤ºå®Œæ•´çš„ã€Œæ§åˆ¶é¢æ¿ã€å’Œè³‡æ–™è¡¨æ ¼ã€‚</p>
                
                <h4>æª¢è¦–é¸é …</h4>
                <ul>
                    <li><strong>åˆ—è¡¨æª¢è¦–</strong>ï¼šé è¨­æ¨¡å¼ï¼Œæ‰€æœ‰è¡¨æ ¼å‚ç›´æ’åˆ—ï¼Œé©åˆè©³ç´°æª¢è¦–ã€‚</li>
                    <li><strong>ç¶²æ ¼æª¢è¦–</strong>ï¼šä»¥å¡ç‰‡å½¢å¼é¡¯ç¤ºè¡¨æ ¼ï¼Œå¯ä½¿ç”¨æ»‘æ¡¿èª¿æ•´æ¯è¡Œé¡¯ç¤ºçš„æ¬„æ•¸ã€‚åœ¨ç¶²æ ¼æ¨¡å¼ä¸‹ï¼Œé»æ“Šå¡ç‰‡å¯é€²å…¥ã€Œå°ˆæ³¨æ¨¡å¼ã€å…¨è¢å¹•æª¢è¦–è©²è¡¨æ ¼ã€‚</li>
                </ul>

                <h4>è¡¨æ ¼å±¤ç´šæ“ä½œ</h4>
                <p>æ‚¨å¯ä»¥å°ã€Œæ•´å€‹è¡¨æ ¼ã€é€²è¡Œæ‰¹æ¬¡æ“ä½œï¼š</p>
                <ul>
                    <li><strong>å‹¾é¸æ‰€æœ‰è¡¨æ ¼ / å–æ¶ˆå‹¾é¸</strong>ï¼šå¿«é€Ÿé¸å–æˆ–å–æ¶ˆæ‰€æœ‰ç›®å‰é¡¯ç¤ºçš„è¡¨æ ¼ã€‚</li>
                    <li><strong>åˆªé™¤é¸å®šè¡¨æ ¼</strong>ï¼šæ°¸ä¹…ç§»é™¤æ‚¨æ‰€å‹¾é¸çš„è¡¨æ ¼ï¼ˆéè¡¨æ ¼å…§çš„è³‡æ–™åˆ—ï¼‰ã€‚</li>
                </ul>

                <h4>è³‡æ–™åˆ—æ“ä½œï¼ˆå…¨å±€ï¼‰</h4>
                <p>é€™äº›æ“ä½œæœƒå½±éŸ¿ã€Œæ‰€æœ‰è¡¨æ ¼ä¸­ã€çš„è³‡æ–™åˆ—ï¼š</p>
                <ul>
                    <li><strong>å³æ™‚æœå°‹ç¯©é¸</strong>ï¼šåœ¨è¼¸å…¥æ¡†ä¸­è¼¸å…¥é—œéµå­—ï¼Œæ‰€æœ‰è¡¨æ ¼æœƒå³æ™‚éš±è—ä¸åŒ…å«è©²é—œéµå­—çš„è³‡æ–™åˆ—ã€‚</li>
                    <li><strong>ä¾é—œéµå­—å‹¾é¸</strong>ï¼š
                        <ul>
                            <li>è¼¸å…¥å–®ä¸€æˆ–å¤šå€‹é—œéµå­—ï¼ˆç”¨ç©ºæ ¼åˆ†éš”ï¼‰ï¼Œé»æ“ŠæŒ‰éˆ•å¯å‹¾é¸ã€ŒåŒæ™‚åŒ…å«ã€æ‰€æœ‰é—œéµå­—çš„è³‡æ–™åˆ—ã€‚</li>
                            <li>è‹¥é—œéµå­—ç”¨é€—è™Ÿ <code>,</code> åˆ†éš”ï¼Œå‰‡æœƒå‹¾é¸ã€ŒåŒ…å«ä»»ä¸€ã€é—œéµå­—çš„è³‡æ–™åˆ—ã€‚</li>
                            <li>å¯å‹¾é¸ã€Œä½¿ç”¨æ­£è¦è¡¨ç¤ºå¼ã€é€²è¡Œæ›´è¤‡é›œçš„åŒ¹é…ã€‚</li>
                        </ul>
                    </li>
                    <li><strong>å‹¾é¸ç©ºç™½åˆ—</strong>ï¼šå‹¾é¸æ‰€æœ‰æ¬„ä½çš†ç‚ºç©ºç™½çš„è³‡æ–™åˆ—ã€‚</li>
                    <li><strong>å‹¾é¸å…¨éƒ¨ / åå‘é¸å–</strong>ï¼šå¿«é€Ÿå…¨é¸æˆ–åè½‰ç›®å‰çš„å‹¾é¸ç‹€æ…‹ã€‚</li>
                    <li><strong>åˆªé™¤å‹¾é¸åˆ—</strong>ï¼šåˆªé™¤æ‰€æœ‰è¡¨æ ¼ä¸­ç›®å‰è¢«å‹¾é¸çš„è³‡æ–™åˆ—ã€‚</li>
                </ul>

                <h4>å…¨å±€èˆ‡åŒ¯å‡º</h4>
                <ul>
                    <li><strong>é¡¯ç¤ºéš±è—è¡Œåˆ—</strong>ï¼šå¦‚æœåŸ Excel æª”ä¸­æœ‰éš±è—çš„è¡Œåˆ—ï¼Œæ­¤æŒ‰éˆ•æœƒå°‡å®ƒå€‘å…¨éƒ¨é¡¯ç¤ºå‡ºä¾†ã€‚</li>
                    <li><strong>åŒ¯å‡º HTML (å…¨éƒ¨ / é¸å–)</strong>ï¼šå°‡ç›®å‰é¡¯ç¤ºçš„è¡¨æ ¼ï¼ˆæˆ–åƒ…å‹¾é¸çš„è³‡æ–™åˆ—ï¼‰åŒ¯å‡ºç‚ºä¸€å€‹ HTML æª”æ¡ˆã€‚</li>
                    <li><strong>åŒ¯å‡º XLSX (å…¨éƒ¨ / é¸å–)</strong>ï¼šå°‡ç›®å‰é¡¯ç¤ºçš„è¡¨æ ¼ï¼ˆæˆ–åƒ…å‹¾é¸çš„è³‡æ–™åˆ—ï¼‰åŒ¯å‡ºç‚ºä¸€å€‹ XLSX æª”æ¡ˆã€‚æ¯å€‹è¡¨æ ¼æœƒå­˜ç‚ºä¸€å€‹ç¨ç«‹çš„å·¥ä½œè¡¨ã€‚</li>
                    <li><strong>åˆä½µæ‰€æœ‰è¡¨æ ¼</strong>ï¼šå°‡æ‰€æœ‰è¡¨æ ¼çš„è³‡æ–™ï¼ˆåŒ…å«è¡¨é ­ï¼‰åˆä½µæˆã€Œå–®ä¸€ä¸€å€‹å·¥ä½œè¡¨ã€ä¸¦åŒ¯å‡ºç‚º XLSX æª”æ¡ˆã€‚</li>
                    <li><strong>é‚„åŸå§‹åˆç‹€æ…‹</strong>ï¼šæ¸…é™¤æ‰€æœ‰ç¯©é¸å’Œåˆªé™¤æ“ä½œï¼Œå°‡è³‡æ–™é‚„åŸåˆ°å‰›è¼‰å…¥æ™‚çš„ç‹€æ…‹ã€‚</li>
                </ul>

                <h3>4. å°ˆæ³¨æ¨¡å¼ï¼ˆç¶²æ ¼æª¢è¦–ï¼‰</h3>
                <p>åœ¨ã€Œç¶²æ ¼æª¢è¦–ã€ä¸‹ï¼Œé»æ“Šä»»ä¸€è¡¨æ ¼å¡ç‰‡ï¼Œè©²è¡¨æ ¼æœƒæ”¾å¤§è‡³å…¨è¢å¹•ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œæ‚¨å¯ä»¥ï¼š</p>
                <ul>
                    <li>é»æ“Šå³ä¸Šè§’çš„ <code>&times;</code> æˆ–æŒ‰ <code>Esc</code> éµé€€å‡ºã€‚</li>
                    <li>é»æ“Šã€Œåˆªé™¤é¸å–åˆ—ã€åƒ…åˆªé™¤æ­¤è¡¨æ ¼ä¸­çš„å‹¾é¸åˆ—ã€‚</li>
                    <li>é»æ“Šã€Œåˆªé™¤æ­¤è¡¨ã€ç›´æ¥åˆªé™¤é€™å€‹è¡¨æ ¼ã€‚</li>
                </ul>

            </section>

            <section id="tab-app-pane" class="tab-pane active">
                <iframe id="app-iframe" title="Excel æª¢è¦–å™¨æ‡‰ç”¨ç¨‹å¼" srcdoc="
                    <!DOCTYPE html>
<html lang=&quot;zh-Hant&quot;>
<head>
    <meta charset=&quot;UTF-8&quot;>
    <meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;>
    <title>Excel æª¢è¦–å™¨ - å¤šæª”æ¡ˆæ•´åˆå·¥å…·</title>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js&quot;></script>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; }

body {
    font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 5px;
}
body.no-scroll {
    overflow: hidden;
    height: 100vh;
}

.page-container,
.container {
    max-width: 1400px;
    margin: 0 auto;
    background: white;
    border-radius: 8px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    overflow: hidden;
}

.header,
.page-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 10px 15px;
    text-align: center;
    position: relative;
}

.header h1, .page-header h1 {
    font-size: 1.4rem;
    margin-bottom: 4px;
}
.header p, .page-header p {
    opacity: 0.9;
    font-size: 0.9rem;
}

.content-area { padding: 10px; }

#drop-area {
    border: 3px dashed #667eea;
    border-radius: 12px;
    padding: 60px 40px; /* é€™è£¡åŠ å¤§å…§è· */
    min-height: 320px;   /* è¨­å®šæœ€å°é«˜åº¦ï¼Œè®“æ‹–æ›³æ¡†è®Šé«˜ */
    font-size: 1.2rem;   /* è®“æ–‡å­—ä¹Ÿæ›´å¤§ */
    text-align: center;
    background: #f8f9fa;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 20px;
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
/* [ CSS ä¿®æ”¹ ] åœ¨ .compact æ¨¡å¼ä¸‹ï¼Œé‡è¨­æœ€å°é«˜åº¦ 
*/
#drop-area.compact { 
    padding: 10px; 
    display: flex; 
    align-items: center; 
    justify-content: space-between; 
    text-align: left; 
    min-height: auto; /* <-- å·²åŠ å…¥æ­¤è¡Œ */
}
#drop-area:hover, #drop-area.highlight {
    background: #e9ecef; border-color: #764ba2; transform: translateY(-2px);
}
#drop-area h3 { color: #667eea; margin-bottom: 8px; font-size: 1.1rem; }
#drop-area.compact h3 { margin-bottom: 0; font-size: 1rem; }
#drop-area p { color: #6c757d; margin-bottom: 10px; }
#drop-area.compact p { margin-bottom: 0; font-size: 0.85rem; }
#file-input { display: none; }

.btn-upload {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white; border: none; padding: 8px 20px;
    border-radius: 8px; font-size: 0.95rem; cursor: pointer; transition: all 0.3s ease;
}
.btn-upload:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2); }

#import-options-container {
    background: #f8f9fa; border-radius: 8px; padding: 10px;
    margin-bottom: 10px; border: 1px solid #e9ecef;
}
#import-options-container fieldset { border: none; padding: 0; margin: 0; }
#import-options-container legend {
    font-weight: 600; color: #495057; padding-bottom: 6px;
    margin-bottom: 6px; width: 100%; border-bottom: 1px solid #dee2e6;
    font-size: 1rem;
}
.import-option { display: block; margin-bottom: 4px; cursor: pointer; padding: 4px; }
.import-option input[type=&quot;radio&quot;] { margin-right: 6px; accent-color: #667eea; }
.input-group { margin-top: 6px; margin-left: 12px; }
.input-group input[type=&quot;text&quot;] {
    padding: 6px 8px; border: 2px solid #dee2e6; border-radius: 6px;
    font-size: 0.85rem; transition: border-color 0.3s ease; width: 100%;
}
.input-group input[type=&quot;text&quot;]:focus { outline: none; border-color: #667eea; }

.file-info { display: flex; align-items: center; gap: 8px; flex: 1; }
.file-info-text { flex: 1; }
.file-count {
    display: inline-block; background: #667eea; color: white;
    padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;
    font-weight: 600; margin-left: 6px;
}
.btn-clear {
    background: #dc3545; color: white; border: none; padding: 4px 10px;
    border-radius: 6px; font-size: 0.8rem; cursor: pointer; transition: all 0.3s ease;
}
.btn-clear:hover { background: #c82333; transform: translateY(-1px); }

.controls { background: #f8f9fa; padding: 10px; border-radius: 8px; margin-bottom: 10px; }
.control-group { margin-bottom: 6px; padding-bottom: 6px; border-bottom: 1px solid #e9ecef; }
.control-group:last-child { margin-bottom: 0; border-bottom: none; padding-bottom: 0; }

.control-group-row {
    display: flex; gap: 10px; margin-bottom: 8px; padding-bottom: 8px; border-bottom: 1px solid #e9ecef;
}
.control-group-row > .control-group { flex: 1; margin-bottom: 0; padding-bottom: 0; border-bottom: none; }

.control-group label { display: block; margin-bottom: 4px; font-weight: 600; color: #495057; font-size: 0.95rem;}
.control-group input[type=&quot;text&quot;] {
    width: 100%; padding: 8px 10px; border: 2px solid #dee2e6;
    border-radius: 8px; font-size: 0.95rem; transition: border-color 0.3s ease;
}
.control-group input[type=&quot;text&quot;]:focus { outline: none; border-color: #667eea; }

.checkbox-label { display: inline-flex; align-items: center; cursor: pointer; font-weight: normal; }
.checkbox-label input[type=&quot;checkbox&quot;] { margin-right: 6px; accent-color: #667eea; cursor: pointer; }
.button-group { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 8px; }
.btn {
    padding: 6px 12px; border: none; border-radius: 8px; font-size: 0.9rem;
    cursor: pointer; transition: all 0.3s ease; font-weight: 500;
}
.btn:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.12); }
.btn.active { background: #343a40; color: white; box-shadow: inset 0 2px 4px rgba(0,0,0,0.2); }
.btn-primary { background: #667eea; color: white; }
.btn-success { background: #28a745; color: white; }
.btn-warning { background: #ffc107; color: #212529; }
.btn-danger { background: #dc3545; color: white; }
.btn-info { background: #17a2b8; color: white; }
.btn-secondary { background: #6c757d; color: white; }
.hidden { display: none !important; }
.status-message {
    background: #fff3cd; border-left: 4px solid #ffc107; padding: 6px;
    border-radius: 8px; margin-bottom: 8px; color: #856404;
}
.info-feedback-box { background-color: #e6f7ff; border: 1px solid #b3e0ff;
    border-radius: 4px; padding: 6px 8px; margin-top: 8px;}
.info-feedback-box h5 { margin: 0 0 4px 0; color: #004085; font-size: 0.85rem;}
.info-feedback-box p { font-size: 0.75rem; color: #0056b3; margin: 0; max-height: 60px; overflow-y: auto; }

.table-wrapper {
    border: 1px solid #dee2e6; border-radius: 8px;
    overflow: hidden; background: #fff;
    display: flex; flex-direction: column;
    box-shadow: 0 1px 6px rgba(0,0,0,0.06);
}
.table-wrapper:hover { box-shadow: 0 2px 12px rgba(0,0,0,0.10);}
.table-header {
    display: flex; align-items: center; gap: 6px; padding: 6px 10px;
    background-color: #f8f9fa; border-bottom: 1px solid #dee2e6;
    flex-shrink: 0;
}
.table-header input[type=&quot;checkbox&quot;] { width: 16px; height: 16px; cursor: pointer; accent-color: #667eea;}
.table-header h4 {
    margin: 0; font-size: 0.95rem; font-weight: 600; color: #495057;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex-grow: 1;
}
.table-content { flex-grow: 1; overflow: auto; min-height: 0; padding: 4px;}
#excel-display-area.list-view .table-wrapper { margin-bottom: 8px;}
#excel-display-area.grid-view { display: grid; grid-template-columns: repeat(var(--grid-columns, 3), 1fr); gap: 10px;}
#excel-display-area.grid-view .table-wrapper { cursor: pointer; max-height: 200px;}
#excel-display-area.grid-view table th { position: static; }
#grid-scale-control { display: flex; align-items: center; gap: 6px; margin-top: 6px;}
#grid-scale-control label { margin-bottom: 0; white-space: nowrap; }
#grid-scale-slider { width: 100%; accent-color: #667eea;}
/* å°ˆæ³¨æ¨¡å¼ */
#excel-display-area .table-wrapper.is-zoomed {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    width: 100vw; height: 100vh;
    z-index: 9999; border-radius: 0; border: none;
    cursor: default; display: flex; flex-direction: column;
    margin: 0; max-width: none; max-height: none; background: white;
    box-shadow: none;
}
#excel-display-area .table-wrapper.is-zoomed .table-header {
    justify-content: space-between; flex-shrink: 0;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white; border-bottom: none;
}
#excel-display-area .table-wrapper.is-zoomed .table-header h4 { color: white; }
#excel-display-area .table-wrapper.is-zoomed .header-actions { display: flex; }
#excel-display-area .table-wrapper.is-zoomed .table-content { flex: 1; min-height: 0; overflow: auto; -webkit-overflow-scrolling: touch; height: 100%;}
#excel-display-area .table-wrapper.is-zoomed .close-zoom { display: block; color: white;}
.header-actions { display: none; align-items: center; gap: 6px; }
.btn-sm { padding: 2px 6px; font-size: 0.8rem;}
.close-zoom { display: none; font-size: 1.3rem; font-weight: bold; line-height: 1; padding: 0 10px; cursor: pointer; border: none; background: none;}

table { width: 100%; border-collapse: collapse; }
table thead { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;}
table th { padding: 6px; text-align: left; font-weight: 600; position: sticky; top: 0; z-index: 1;}
table td { padding: 6px; border-bottom: 1px solid #dee2e6; }
table tbody tr:hover { background: #f8f9fa; }
.checkbox-cell { width: 32px; text-align: center; }
.checkbox-cell input[type=&quot;checkbox&quot;] { cursor: pointer; width: 16px; height: 16px; accent-color: #667eea;}
.row-hidden-search { display: none; }

#back-to-top-btn { position: fixed; bottom: 10px; right: 10px; width: 36px; height: 36px;
    border-radius: 50%; background: #667eea; color: white; border: none;
    font-size: 18px; cursor: pointer; display: flex; align-items: center;
    justify-content: center; box-shadow: 0 2px 6px rgba(102, 126, 234, 0.2);
    opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s, transform 0.3s; z-index: 1000;
}
#back-to-top-btn.visible { opacity: 1; visibility: visible; }
#back-to-top-btn:hover { transform: translateY(-2px); background: #5a6fd8; }

body::-webkit-scrollbar, .table-content::-webkit-scrollbar {
    width: 8px; height: 8px;
}
body::-webkit-scrollbar-track, .table-content::-webkit-scrollbar-track {
    background: #f1f1f1;
}
body::-webkit-scrollbar-thumb, .table-content::-webkit-scrollbar-thumb {
    background-color: #888; border-radius: 6px; border: 2px solid #f1f1f1;
}
body::-webkit-scrollbar-thumb:hover, .table-content::-webkit-scrollbar-thumb:hover {
    background-color: #555;
}

@media (max-width: 992px) {
    .control-group-row { flex-direction: column; gap: 0; }
}
@media (max-width: 768px) {
    body { padding: 3px;}
    .content-area { padding: 6px;}
    .header h1, .page-header h1 { font-size: 1.05rem;}
    #drop-area { padding: 12px 6px;}
    table th, table td { padding: 4px;}
    #back-to-top-btn { bottom: 6px; right: 6px; width: 28px; height: 28px; font-size: 14px;}
}
.loading { text-align: center; padding: 20px; color: #667eea; font-size: 1rem;}
.loading::after { content: '...'; animation: dots 1.5s steps(4, end) infinite; }
@keyframes dots { 0%, 20% { content: '.'; } 40% { content: '..'; } 60%, 100% { content: '...'; } }

body.no-scroll .controls { display: none !important; }

* {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

    </style>
</head>
<body>

    <div class=&quot;page-container&quot;>
        
        <header class=&quot;page-header&quot;>
            <h1>Excel æª¢è¦–å™¨</h1>
            <p>æ”¯æ´å¤šæª”æ¡ˆã€å¤šå·¥ä½œè¡¨æ•´åˆ | å¼·å¤§çš„ç¯©é¸èˆ‡åŒ¯å‡ºåŠŸèƒ½</p>
        </header>
        
        <main class=&quot;content-area&quot;>
            <div id=&quot;import-options-container&quot;>
                <fieldset>
                    <legend>âš™ï¸ æ­¥é©Ÿä¸€ï¼šé¸æ“‡åŒ¯å…¥æ–¹å¼</legend>
                    <label class=&quot;import-option&quot;><input type=&quot;radio&quot; name=&quot;import-mode&quot; value=&quot;all&quot;> åŒ¯å…¥æ‰€æœ‰å·¥ä½œè¡¨</label>
                    <label class=&quot;import-option&quot;><input type=&quot;radio&quot; name=&quot;import-mode&quot; value=&quot;first&quot; checked> åƒ…åŒ¯å…¥ç¬¬ä¸€å¼µå·¥ä½œè¡¨</label>
                    <label class=&quot;import-option&quot;><input type=&quot;radio&quot; name=&quot;import-mode&quot; value=&quot;position&quot;> åŒ¯å…¥æŒ‡å®šä½ç½®</label>
                    <div id=&quot;specific-sheet-position-group&quot; class=&quot;input-group hidden&quot;><input type=&quot;text&quot; id=&quot;specific-sheet-position-input&quot; placeholder=&quot;ä¾‹å¦‚: 1, 3, 5-7&quot;></div>
                    <label class=&quot;import-option&quot;><input type=&quot;radio&quot; name=&quot;import-mode&quot; value=&quot;specific&quot;> åŒ¯å…¥æŒ‡å®šåç¨±</label>
                    <div id=&quot;specific-sheet-name-group&quot; class=&quot;input-group hidden&quot;><input type=&quot;text&quot; id=&quot;specific-sheet-name-input&quot; placeholder=&quot;è«‹è¼¸å…¥åç¨±é—œéµå­—&quot;></div>
                    <label class=&quot;import-option&quot;><input type=&quot;radio&quot; name=&quot;import-mode&quot; value=&quot;manual&quot;> é€ä¸€æª”æ¡ˆæ‰‹å‹•æ±ºå®š</label>
                </fieldset>
            </div>

            <div id=&quot;drop-area&quot;>
                <input type=&quot;file&quot; id=&quot;file-input&quot; accept=&quot;.xls,.xlsx&quot; multiple>
                <div id=&quot;drop-area-initial&quot;><h3>ğŸ“ æ­¥é©ŸäºŒï¼šæ‹–æ”¾æª”æ¡ˆåˆ°æ­¤è™•</h3><p>æˆ–é»æ“Šä¸‹æ–¹æŒ‰éˆ•é¸æ“‡æª”æ¡ˆ</p><button class=&quot;btn-upload&quot;>é¸æ“‡ Excel æª”æ¡ˆ</button></div>
                <div id=&quot;drop-area-loaded&quot; class=&quot;hidden&quot;><div class=&quot;file-info&quot;><div class=&quot;file-info-text&quot;><h3>ğŸ“Š å·²è¼‰å…¥æª”æ¡ˆ <span class=&quot;file-count&quot; id=&quot;file-count&quot;>0</span></h3><p id=&quot;file-names&quot;>-</p></div><button class=&quot;btn-clear&quot; id=&quot;clear-files-btn&quot;>ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰æª”æ¡ˆ</button></div></div>
            </div>

            <div class=&quot;controls hidden&quot; id=&quot;control-panel&quot;>
                <div class=&quot;control-group-row&quot;>
                    <div class=&quot;control-group&quot;>
                        <label>ğŸ‘ï¸ æª¢è¦–é¸é …</label>
                        <div class=&quot;button-group&quot;>
                            <button class=&quot;btn btn-secondary active&quot; id=&quot;list-view-btn&quot;>åˆ—è¡¨æª¢è¦–</button>
                            <button class=&quot;btn btn-secondary&quot; id=&quot;grid-view-btn&quot;>ç¶²æ ¼æª¢è¦–</button>
                        </div>
                        <div id=&quot;grid-scale-control&quot; class=&quot;hidden&quot;>
                            <label for=&quot;grid-scale-slider&quot;>èª¿æ•´æ¬„æ•¸:</label>
                            <input type=&quot;range&quot; id=&quot;grid-scale-slider&quot; min=&quot;1&quot; max=&quot;5&quot; value=&quot;3&quot;>
                        </div>
                    </div>
                    <div class=&quot;control-group&quot; id=&quot;table-level-controls&quot;>
                        <label>ğŸ“‹ è¡¨æ ¼å±¤ç´šæ“ä½œ</label>
                        <div class=&quot;button-group&quot;>
                            <button class=&quot;btn btn-primary&quot; id=&quot;select-all-tables-btn&quot;>å‹¾é¸æ‰€æœ‰è¡¨æ ¼</button>
                            <button class=&quot;btn btn-secondary&quot; id=&quot;unselect-all-tables-btn&quot;>å–æ¶ˆå‹¾é¸</button>
                            <button class=&quot;btn btn-danger&quot; id=&quot;delete-selected-tables-btn&quot;>åˆªé™¤é¸å®šè¡¨æ ¼</button>
                        </div>
                        <div id=&quot;selected-tables-info&quot; class=&quot;info-feedback-box hidden&quot;>
                            <h5>ç›®å‰é¸å–çš„è¡¨æ ¼ï¼š</h5>
                            <p id=&quot;selected-tables-list&quot;></p>
                        </div>
                    </div>
                </div>

                <div class=&quot;control-group-row&quot;>
                    <div class=&quot;control-group&quot;>
                        <label for=&quot;search-input&quot;>ğŸ” å³æ™‚æœå°‹ç¯©é¸</label>
                        <input type=&quot;text&quot; id=&quot;search-input&quot; placeholder=&quot;è¼¸å…¥é—œéµå­—ä»¥ç¯©é¸è³‡æ–™åˆ—...&quot;>
                    </div>
                    <div class=&quot;control-group&quot; id=&quot;select-by-keyword-group&quot;>
                        <label>âœ… ä¾é—œéµå­—å‹¾é¸</label>
                        <input type=&quot;text&quot; id=&quot;select-keyword-input&quot; placeholder=&quot;å¤šé—œéµå­—ç”¨ç©ºæ ¼(AND)æˆ–é€—è™Ÿ(OR)åˆ†éš”&quot;>
                        <label class=&quot;checkbox-label&quot;><input type=&quot;checkbox&quot; id=&quot;select-keyword-regex&quot;> ä½¿ç”¨æ­£è¦è¡¨ç¤ºå¼</label>
                    </div>
                </div>
                
                <div class=&quot;control-group&quot;>
                    <label>â–¶ï¸ è³‡æ–™åˆ—æ“ä½œ</label>
                    <div class=&quot;button-group&quot;>
                        <button class=&quot;btn btn-primary&quot; id=&quot;select-by-keyword-btn&quot;>ä¾é—œéµå­—å‹¾é¸</button>
                        <button class=&quot;btn btn-primary&quot; id=&quot;select-empty-btn&quot;>å‹¾é¸ç©ºç™½åˆ—</button>
                        <button class=&quot;btn btn-primary&quot; id=&quot;select-all-btn&quot;>å‹¾é¸å…¨éƒ¨</button>
                        <button class=&quot;btn btn-warning&quot; id=&quot;invert-selection-btn&quot;>åå‘é¸å–</button>
                        <button class=&quot;btn btn-danger&quot; id=&quot;delete-selected-btn&quot;>åˆªé™¤å‹¾é¸åˆ—</button>
                    </div>
                </div>

                <div class=&quot;control-group&quot;>
                         <label>ğŸ”„ å…¨å±€èˆ‡åŒ¯å‡º</label>
                         <div class=&quot;button-group&quot;>
                            <button class=&quot;btn btn-info&quot; id=&quot;show-hidden-btn&quot;>é¡¯ç¤ºéš±è—è¡Œåˆ—</button>
                            <button class=&quot;btn btn-success&quot; id=&quot;export-html-btn&quot;>åŒ¯å‡º HTML (å…¨éƒ¨)</button>
                            <button class=&quot;btn btn-success&quot; id=&quot;export-selected-btn&quot;>åŒ¯å‡º HTML (é¸å–)</button>
                            <button class=&quot;btn btn-success&quot; id=&quot;export-xlsx-btn&quot;>åŒ¯å‡º XLSX (å…¨éƒ¨)</button>
                            <button class=&quot;btn btn-success&quot; id=&quot;export-selected-xlsx-btn&quot;>åŒ¯å‡º XLSX (é¸å–)</button>
                            <button class=&quot;btn btn-success&quot; id=&quot;export-merged-xlsx-btn&quot;>åˆä½µæ‰€æœ‰è¡¨æ ¼</button>
                            <button class=&quot;btn btn-secondary&quot; id=&quot;reset-view-btn&quot;>é‚„åŸå§‹åˆç‹€æ…‹</button>
                        </div>
                </div>
            </div>
            <div class=&quot;status-message hidden&quot; id=&quot;load-status-message&quot;></div>
            
            <section id=&quot;excel-display-area&quot; class=&quot;list-view&quot;></section>

        </main>
    </div>
    
    <button id=&quot;back-to-top-btn&quot; title=&quot;å›åˆ°å·¥å…·åˆ—&quot;>â†‘</button>

    <script>
        const ExcelViewer = (() => {
            'use strict';
            const CONSTANTS = { VALID_FILE_EXTENSIONS: ['.xls', '.xlsx'] };
            const state = { 
                originalHtmlString: '', 
                isProcessing: false, 
                loadedFiles: [], 
                loadedTables: 0, 
                zoomedCard: null 
            };
            const elements = {};

            function init() {
                cacheElements();
                bindEvents();
            }

            function cacheElements() {
                const mapping = {
                    fileInput: 'file-input', displayArea: 'excel-display-area', searchInput: 'search-input',
                    dropArea: 'drop-area', deleteSelectedBtn: 'delete-selected-btn', invertSelectionBtn: 'invert-selection-btn',
                    resetViewBtn: 'reset-view-btn', selectEmptyBtn: 'select-empty-btn', exportHtmlBtn: 'export-html-btn',
                    showHiddenBtn: 'show-hidden-btn', exportSelectedBtn: 'export-selected-btn', exportXlsxBtn: 'export-xlsx-btn',
                    exportSelectedXlsxBtn: 'export-selected-xlsx-btn', exportMergedXlsxBtn: 'export-merged-xlsx-btn',
                    selectByKeywordGroup: 'select-by-keyword-group', selectKeywordInput: 'select-keyword-input',
                    selectByKeywordBtn: 'select-by-keyword-btn', selectKeywordRegex: 'select-keyword-regex',
                    loadStatusMessage: 'load-status-message', controlPanel: 'control-panel',
                    dropAreaInitial: 'drop-area-initial', dropAreaLoaded: 'drop-area-loaded',
                    fileCount: 'file-count', fileNames: 'file-names', clearFilesBtn: 'clear-files-btn',
                    selectAllBtn: 'select-all-btn',
                    importOptionsContainer: 'import-options-container', specificSheetNameGroup: 'specific-sheet-name-group',
                    specificSheetNameInput: 'specific-sheet-name-input', specificSheetPositionGroup: 'specific-sheet-position-group',
                    specificSheetPositionInput: 'specific-sheet-position-input', selectAllTablesBtn: 'select-all-tables-btn',
                    unselectAllTablesBtn: 'unselect-all-tables-btn', deleteSelectedTablesBtn: 'delete-selected-tables-btn',
                    tableLevelControls: 'table-level-controls', selectedTablesInfo: 'selected-tables-info',
                    selectedTablesList: 'selected-tables-list', listViewBtn: 'list-view-btn',
                    gridViewBtn: 'grid-view-btn', backToTopBtn: 'back-to-top-btn',
                    gridScaleControl: 'grid-scale-control', gridScaleSlider: 'grid-scale-slider'
                };
                Object.keys(mapping).forEach(key => {
                    elements[key] = document.getElementById(mapping[key]);
                });
            }

            function bindEvents() {
                elements.fileInput.addEventListener('change', e => processFiles(e.target.files));
                setupDragAndDrop();
                elements.displayArea.addEventListener('change', handleDisplayAreaChange);
                elements.displayArea.addEventListener('click', handleCardClick);
                elements.importOptionsContainer.addEventListener('change', e => {
                    if (e.target.name === 'import-mode') {
                        const selectedMode = e.target.value;
                        elements.specificSheetNameGroup.classList.toggle('hidden', selectedMode !== 'specific');
                        elements.specificSheetPositionGroup.classList.toggle('hidden', selectedMode !== 'position');
                    }
                });
                elements.listViewBtn.addEventListener('click', () => setViewMode('list'));
                elements.gridViewBtn.addEventListener('click', () => setViewMode('grid'));
                elements.gridScaleSlider.addEventListener('input', updateGridScale);
                elements.selectAllTablesBtn.addEventListener('click', () => { selectAllTables(true); updateSelectionInfo(); });
                elements.unselectAllTablesBtn.addEventListener('click', () => { selectAllTables(false); updateSelectionInfo(); });
                elements.deleteSelectedTablesBtn.addEventListener('click', deleteSelectedTables);
                const rowSelectionButtons = [elements.selectEmptyBtn, elements.deleteSelectedBtn, elements.selectAllBtn, elements.invertSelectionBtn, elements.selectByKeywordBtn];
                rowSelectionButtons.forEach(btn => btn.addEventListener('click', () => {
                    setTimeout(() => {
                        elements.displayArea.querySelectorAll('table').forEach(syncTableCheckboxState);
                        updateSelectionInfo();
                    }, 0);
                }));
                elements.resetViewBtn.addEventListener('click', resetView);
                elements.exportHtmlBtn.addEventListener('click', () => exportHtml('all'));
                elements.exportSelectedBtn.addEventListener('click', () => exportHtml('selected'));
                elements.exportXlsxBtn.addEventListener('click', () => exportXlsx('all'));
                elements.exportSelectedXlsxBtn.addEventListener('click', () => exportXlsx('selected'));
                elements.exportMergedXlsxBtn.addEventListener('click', exportMergedXlsx);
                elements.showHiddenBtn.addEventListener('click', showAllHiddenElements);
                elements.clearFilesBtn.addEventListener('click', () => clearAllFiles(false));
                elements.searchInput.addEventListener('input', debounce(filterTable, 300));
                elements.backToTopBtn.addEventListener('click', scrollToTop);
                window.addEventListener('scroll', handleScroll);
                document.addEventListener('keydown', e => { if (e.key === 'Escape' && state.zoomedCard) closePreview(); });
            }

            function handleDisplayAreaChange(e) { const target = e.target; if (!target.matches('.table-select-checkbox, [id^=&quot;select-all-checkbox&quot;], .row-checkbox')) return; let table; if (target.matches('.table-select-checkbox')) { const wrapper = target.closest('.table-wrapper'); table = wrapper ? wrapper.querySelector('table') : null; if (table) { toggleSelectAll(target.checked, table); } } else if (target.matches('[id^=&quot;select-all-checkbox&quot;]')) { table = target.closest('table'); toggleSelectAll(target.checked, table); } else { table = target.closest('table'); } if (table) { syncTableCheckboxState(table); } updateSelectionInfo(); }
            function syncTableCheckboxState(table) { const wrapper = table.closest('.table-wrapper'); if (!wrapper) return; const headerCheckbox = wrapper.querySelector('.table-select-checkbox'); const rowCheckboxes = table.querySelectorAll('tbody tr:not(.row-hidden-search) .row-checkbox'); if (rowCheckboxes.length === 0) { headerCheckbox.checked = false; headerCheckbox.indeterminate = false; return; } const checkedCount = Array.from(rowCheckboxes).filter(cb => cb.checked).length; if (checkedCount === 0) { headerCheckbox.checked = false; headerCheckbox.indeterminate = false; } else if (checkedCount === rowCheckboxes.length) { headerCheckbox.checked = true; headerCheckbox.indeterminate = false; } else { headerCheckbox.checked = false; headerCheckbox.indeterminate = true; } }
            function updateSelectionInfo() { const selectedCheckboxes = elements.displayArea.querySelectorAll('.table-select-checkbox:checked, .table-select-checkbox:indeterminate'); if (selectedCheckboxes.length > 0) { const names = Array.from(selectedCheckboxes).map(cb => cb.closest('.table-header').querySelector('h4').textContent); elements.selectedTablesList.textContent = names.join('; '); elements.selectedTablesInfo.classList.remove('hidden'); } else { elements.selectedTablesInfo.classList.add('hidden'); } }
            function setupDragAndDrop() { elements.dropArea.addEventListener('click', e => { if (e.target.id === 'clear-files-btn' || e.target.id === 'file-input') return; elements.fileInput.click(); }); ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => { elements.dropArea.addEventListener(eventName, e => { e.preventDefault(); e.stopPropagation(); }); }); ['dragenter', 'dragover'].forEach(eventName => { elements.dropArea.addEventListener(eventName, () => elements.dropArea.classList.add('highlight')); }); ['dragleave', 'drop'].forEach(eventName => { elements.dropArea.addEventListener(eventName, () => elements.dropArea.classList.remove('highlight')); }); elements.dropArea.addEventListener('drop', e => processFiles(e.dataTransfer.files)); }
            async function processFiles(fileList) { const validation = validateFiles(fileList); if (!validation.valid) { alert(`éŒ¯èª¤ï¼š${validation.error}`); return; } if (state.isProcessing) { alert('æ­£åœ¨è™•ç†æª”æ¡ˆ...'); return; } const importMode = document.querySelector('input[name=&quot;import-mode&quot;]:checked').value; const specificSheetName = elements.specificSheetNameInput.value.trim(); const specificSheetPosition = elements.specificSheetPositionInput.value.trim(); if (importMode === 'specific' && !specificSheetName) { alert('è«‹è¼¸å…¥å·¥ä½œè¡¨åç¨±ï¼'); return; } if (importMode === 'position' && !specificSheetPosition) { alert('è«‹è¼¸å…¥å·¥ä½œè¡¨ä½ç½®ï¼'); return; } state.isProcessing = true; elements.displayArea.innerHTML = '<div class=&quot;loading&quot;>è®€å–ä¸­...</div>'; resetControls(true); const tablesToRender = []; const missedFiles = []; state.loadedFiles = []; try { for (let index = 0; index < validation.files.length; index++) { const file = validation.files[index]; elements.displayArea.innerHTML = `<div class=&quot;loading&quot;>è®€å–ä¸­... (${index + 1}/${validation.files.length})</div>`; const binaryData = await readFileAsBinary(file); const workbook = XLSX.read(binaryData, { type: 'binary' }); const sheetNames = await getSelectedSheetNames(file.name, workbook, importMode, { name: specificSheetName, position: specificSheetPosition }); if ((importMode === 'specific' || importMode === 'position') && sheetNames.length === 0 && workbook.SheetNames.length > 0) { missedFiles.push(file.name); } for (const sheetName of sheetNames) { const sheet = workbook.Sheets[sheetName]; const htmlString = XLSX.utils.sheet_to_html(sheet); tablesToRender.push({ html: htmlString, filename: `${file.name} (${sheetName})` }); state.loadedFiles.push(`${file.name} (${sheetName})`); } } if (missedFiles.length > 0) { const criteria = importMode === 'specific' ? `åç¨±åŒ…å« &quot;${specificSheetName}&quot;` : `ä½ç½®ç¬¦åˆ &quot;${specificSheetPosition}&quot;`; alert(`ä»¥ä¸‹æª”æ¡ˆæ‰¾ä¸åˆ° ${criteria} çš„å·¥ä½œè¡¨ï¼š\n\n- ${missedFiles.join('\n- ')}`); } state.loadedTables = tablesToRender.length; renderTables(tablesToRender); updateDropAreaDisplay(); } catch (err) { console.error(&quot;è™•ç†æª”æ¡ˆæ™‚ç™¼ç”ŸéŒ¯èª¤:&quot;, err); elements.displayArea.innerHTML = `<p style=&quot;color: red;&quot;>è™•ç†æª”æ¡ˆéŒ¯èª¤ï¼š${err.message || 'æœªçŸ¥éŒ¯èª¤'}</p>`; resetControls(true); } finally { state.isProcessing = false; } }
            function readFileAsBinary(file) { return new Promise((resolve, reject) => { const reader = new FileReader(); reader.onload = e => resolve(e.target.result); reader.onerror = reject; reader.readAsBinaryString(file); }); }
            function parsePositionString(str) { const indices = new Set(); const parts = str.split(',').map(p => p.trim()).filter(Boolean); for (const part of parts) { if (part.includes('-')) { const [start, end] = part.split('-').map(Number); if (!isNaN(start) && !isNaN(end) && start <= end) { for (let i = start; i <= end; i++) indices.add(i - 1); } } else { const num = Number(part); if (!isNaN(num)) indices.add(num - 1); } } return Array.from(indices).sort((a, b) => a - b); }
            async function getSelectedSheetNames(filename, workbook, mode, criteria) { const sheetNames = workbook.SheetNames; if (sheetNames.length === 0) return []; switch (mode) { case 'all': return sheetNames; case 'first': return sheetNames.length > 0 ? [sheetNames[0]] : []; case 'specific': return sheetNames.filter(name => name.toLowerCase().includes(criteria.name.toLowerCase())); case 'position': return parsePositionString(criteria.position).map(index => sheetNames[index]).filter(Boolean); case 'manual': return await showWorksheetSelectionModal(filename, sheetNames); default: return []; } }
            function showWorksheetSelectionModal(filename, sheetNames) { return new Promise(resolve => { if (sheetNames.length <= 1) { resolve(sheetNames); return; } const overlay = document.createElement('div'); overlay.className = 'modal-overlay'; const dialog = document.createElement('div'); dialog.className = 'modal-dialog'; dialog.innerHTML = `<div class=&quot;modal-header&quot;><h3>é¸æ“‡å·¥ä½œè¡¨ (æ‰‹å‹•æ¨¡å¼)</h3><p>æª”æ¡ˆ &quot;<strong>${filename}</strong>&quot;</p></div><div class=&quot;modal-quick-actions&quot;><button class=&quot;btn btn-primary btn-sm&quot; id=&quot;modal-select-all&quot;>å…¨é¸</button><button class=&quot;btn btn-secondary btn-sm&quot; id=&quot;modal-select-none&quot;>å…¨ä¸é¸</button></div><div class=&quot;modal-body&quot;><ul class=&quot;sheet-list&quot;>${sheetNames.map(name => `<li class=&quot;sheet-item&quot;><label><input type=&quot;checkbox&quot; class=&quot;sheet-checkbox&quot; value=&quot;${name}&quot; checked> ${name}</label></li>`).join('')}</ul></div><div class=&quot;modal-footer&quot;><button class=&quot;btn btn-secondary&quot; id=&quot;modal-skip&quot;>è·³é</button><button class=&quot;btn btn-success&quot; id=&quot;modal-confirm&quot;>ç¢ºèª</button></div>`; overlay.appendChild(dialog); document.body.appendChild(overlay); const checkboxes = dialog.querySelectorAll('.sheet-checkbox'); const closeModal = () => document.body.removeChild(overlay); dialog.querySelector('#modal-confirm').addEventListener('click', () => { resolve(Array.from(checkboxes).filter(cb => cb.checked).map(cb => cb.value)); closeModal(); }); dialog.querySelector('#modal-skip').addEventListener('click', () => { resolve([]); closeModal(); }); dialog.querySelector('#modal-select-all').addEventListener('click', () => checkboxes.forEach(cb => cb.checked = true)); dialog.querySelector('#modal-select-none').addEventListener('click', () => checkboxes.forEach(cb => cb.checked = false)); }); }
            function renderTables(tablesToRender) { if (tablesToRender.length === 0) { elements.displayArea.innerHTML = `<p>æ²’æœ‰æ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„å·¥ä½œè¡¨ã€‚</p>`; return; } const fragment = document.createDocumentFragment(); tablesToRender.forEach(({ html, filename }) => { const wrapper = document.createElement('div'); wrapper.className = 'table-wrapper'; const header = document.createElement('div'); header.className = 'table-header'; header.innerHTML = `<input type=&quot;checkbox&quot; class=&quot;table-select-checkbox&quot; title=&quot;é¸å–æ­¤è¡¨æ ¼&quot;><h4>${filename}</h4><div class=&quot;header-actions&quot;><button class=&quot;btn btn-danger btn-sm delete-rows-btn&quot;>åˆªé™¤é¸å–åˆ—</button><button class=&quot;btn btn-danger btn-sm delete-table-btn&quot;>åˆªé™¤æ­¤è¡¨</button></div><button class=&quot;close-zoom&quot;>&times;</button>`; const tableContent = document.createElement('div'); tableContent.className = 'table-content'; const tempDiv = document.createElement('div'); tempDiv.innerHTML = html; const table = tempDiv.querySelector('table'); if (table) { tableContent.appendChild(table); wrapper.appendChild(header); wrapper.appendChild(tableContent); fragment.appendChild(wrapper); } }); elements.displayArea.innerHTML = ''; elements.displayArea.appendChild(fragment); state.originalHtmlString = elements.displayArea.innerHTML; injectCheckboxes(); showControls(detectHiddenElements()); }
            function injectCheckboxes() { elements.displayArea.querySelectorAll('thead tr').forEach((headRow, index) => { const th = document.createElement('th'); th.innerHTML = `<input type=&quot;checkbox&quot; id=&quot;select-all-checkbox-${index}&quot; title=&quot;å…¨é¸/å…¨ä¸é¸&quot;>`; th.classList.add('checkbox-cell'); headRow.prepend(th); }); elements.displayArea.querySelectorAll('tbody tr').forEach(row => { const td = document.createElement('td'); td.innerHTML = '<input type=&quot;checkbox&quot; class=&quot;row-checkbox&quot;>'; td.classList.add('checkbox-cell'); row.prepend(td); }); }
            function toggleSelectAll(isChecked, table) { if (!table) return; table.querySelectorAll('tbody tr:not(.row-hidden-search) .row-checkbox').forEach(cb => cb.checked = isChecked); }
            function detectHiddenElements() { return elements.displayArea.querySelectorAll('tr[style*=&quot;display: none&quot;], td[style*=&quot;display: none&quot;], th[style*=&quot;display: none&quot;]').length; }
            function showAllHiddenElements() { const hidden = elements.displayArea.querySelectorAll('tr[style*=&quot;display: none&quot;], td[style*=&quot;display: none&quot;], th[style*=&quot;display: none&quot;]'); if (hidden.length === 0) { alert('æ²’æœ‰éœ€è¦é¡¯ç¤ºçš„éš±è—è¡Œåˆ—ã€‚'); return; } hidden.forEach(el => el.style.display = ''); alert(`å·²é¡¯ç¤º ${hidden.length} å€‹éš±è—çš„è¡Œåˆ—ã€‚`); elements.showHiddenBtn.classList.add('hidden'); elements.loadStatusMessage.classList.add('hidden'); }
            function selectAllTables(isChecked) { elements.displayArea.querySelectorAll('.table-select-checkbox').forEach(cb => { if (cb.checked !== isChecked) { cb.click(); } }); }
            function deleteSelectedTables() { const selectedWrappers = Array.from(elements.displayArea.querySelectorAll('.table-select-checkbox:checked')).map(cb => cb.closest('.table-wrapper')); if (selectedWrappers.length === 0) { alert('è«‹å…ˆå‹¾é¸è¦åˆªé™¤çš„è¡¨æ ¼ã€‚'); return; } if (confirm(`ç¢ºå®šè¦æ°¸ä¹…åˆªé™¤ ${selectedWrappers.length} å€‹é¸å®šçš„è¡¨æ ¼å—ï¼Ÿ`)) { selectedWrappers.forEach(wrapper => wrapper.remove()); updateFileStateAfterDeletion(); } }
            function updateFileStateAfterDeletion() { const remainingWrappers = elements.displayArea.querySelectorAll('.table-wrapper'); state.loadedTables = remainingWrappers.length; state.loadedFiles = Array.from(remainingWrappers).map(w => w.querySelector('h4').textContent); if (state.loadedTables === 0) { clearAllFiles(true); } else { updateDropAreaDisplay(); } }
            function selectByKeyword() { const keywordInput = elements.selectKeywordInput.value.trim(); const isRegex = elements.selectKeywordRegex.checked; if (!keywordInput) { alert('è«‹å…ˆè¼¸å…¥é—œéµå­—'); return; } let matchLogic; try { if (isRegex) { const regex = new RegExp(keywordInput, 'i'); matchLogic = text => regex.test(text); } else if (keywordInput.includes(',')) { const keywords = keywordInput.split(',').map(k => k.trim().toLowerCase()).filter(Boolean); matchLogic = text => keywords.some(k => text.includes(k)); } else { const keywords = keywordInput.split(/\s+/).map(k => k.trim().toLowerCase()).filter(Boolean); matchLogic = text => keywords.every(k => text.includes(k)); } } catch (e) { alert('ç„¡æ•ˆçš„ Regex è¡¨ç¤ºå¼ï¼š\n' + e.message); return; } let count = 0; elements.displayArea.querySelectorAll('tbody tr:not(.row-hidden-search)').forEach(row => { if (matchLogic(Array.from(row.cells).slice(1).map(c => c.textContent).join(' '))) { row.querySelector('.row-checkbox').checked = true; count++; } }); alert(count > 0 ? `å·²å‹¾é¸ ${count} å€‹ç¬¦åˆæ¢ä»¶çš„åˆ—` : `æœªæ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„åˆ—`); }
            function selectEmptyRows() { let count = 0; elements.displayArea.querySelectorAll('tbody tr:not(.row-hidden-search)').forEach(row => { if (Array.from(row.cells).slice(1).every(c => c.textContent.trim() === '')) { row.querySelector('.row-checkbox').checked = true; count++; } }); if (count === 0) alert('æœªæ‰¾åˆ°ç©ºç™½åˆ—'); }
            function selectAllRows() { const rows = elements.displayArea.querySelectorAll('tbody tr:not(.row-hidden-search)'); if (rows.length === 0) { alert('æ²’æœ‰å¯å‹¾é¸çš„åˆ—'); return; } rows.forEach(row => row.querySelector('.row-checkbox').checked = true); elements.displayArea.querySelectorAll('[id^=&quot;select-all-checkbox&quot;]').forEach(cb => cb.checked = true); }
            function invertSelection() { elements.displayArea.querySelectorAll('tbody tr:not(.row-hidden-search) .row-checkbox').forEach(cb => cb.checked = !cb.checked); }
            function deleteSelectedRows(scope) { const selected = scope.querySelectorAll('.row-checkbox:checked'); if (selected.length === 0) { alert('è«‹å…ˆå‹¾é¸è¦åˆªé™¤çš„åˆ—'); return; } if (confirm(`ç¢ºå®šè¦åˆªé™¤ ${selected.length} ç­†è³‡æ–™åˆ—å—ï¼Ÿ`)) { selected.forEach(cb => cb.closest('tr').remove()); } }
            function filterTable() { const keywords = elements.searchInput.value.toLowerCase().trim().split(/\s+/).filter(Boolean); elements.displayArea.querySelectorAll('.table-wrapper').forEach(wrapper => { let visibleRowCount = 0; wrapper.querySelectorAll('tbody tr').forEach(row => { const text = Array.from(row.cells).slice(1).map(c => c.textContent).join(' ').toLowerCase(); const isVisible = keywords.every(k => text.includes(k)); row.classList.toggle('row-hidden-search', !isVisible); if (isVisible) visibleRowCount++; }); wrapper.style.display = visibleRowCount > 0 ? '' : 'none'; }); elements.displayArea.querySelectorAll('table').forEach(syncTableCheckboxState); updateSelectionInfo(); }
            function extractTableData(table, { onlySelected = false, includeFilename = false } = {}) { const data = []; const headerRow = table.querySelector('thead tr'); if (headerRow) { let headerData = Array.from(headerRow.querySelectorAll('th:not(.checkbox-cell)')).map(th => th.textContent.trim()); if (includeFilename) { headerData.unshift('Source File'); } data.push(headerData); } const filename = includeFilename ? table.closest('.table-wrapper').querySelector('h4').textContent : null; const rows = onlySelected ? Array.from(table.querySelectorAll('tbody .row-checkbox:checked')).map(cb => cb.closest('tr')) : table.querySelectorAll('tbody tr:not(.row-hidden-search)'); rows.forEach(row => { let rowData = Array.from(row.querySelectorAll('td:not(.checkbox-cell)')).map(td => td.textContent.trim()); if (includeFilename) { rowData.unshift(filename); } data.push(rowData); }); return data; }
            function exportHtml(mode) { const tables = Array.from(elements.displayArea.querySelectorAll('.table-wrapper:not([style*=&quot;display: none&quot;]) table')); if (tables.length === 0) { alert('æ²’æœ‰å¯åŒ¯å‡ºçš„è¡¨æ ¼ã€‚'); return; } let content = ''; if (mode === 'all') { content = tables.map(table => { const clone = table.cloneNode(true); clone.querySelectorAll('.checkbox-cell').forEach(el => el.remove()); return clone.outerHTML; }).join('<br><hr><br>'); } else { if (elements.displayArea.querySelectorAll('.row-checkbox:checked').length === 0) { alert('è«‹å…ˆå‹¾é¸è¦åŒ¯å‡ºçš„è³‡æ–™åˆ—ã€‚'); return; } content = tables.map(table => { const selectedRows = table.querySelectorAll('tbody .row-checkbox:checked'); if (selectedRows.length === 0) return ''; const headerClone = table.querySelector('thead').cloneNode(true); headerClone.querySelector('.checkbox-cell')?.remove(); const rowsHtml = Array.from(selectedRows).map(cb => { const rowClone = cb.closest('tr').cloneNode(true); rowClone.querySelector('.checkbox-cell')?.remove(); return rowClone.outerHTML; }).join(''); return `<table>${headerClone.outerHTML}<tbody>${rowsHtml}</tbody></table>`; }).join('<br><hr><br>'); } if (!content) { alert('æ²’æœ‰æ‰¾åˆ°å¯åŒ¯å‡ºçš„å…§å®¹ã€‚'); return; } const title = `åŒ¯å‡ºå ±è¡¨ (${mode === 'all' ? 'å…¨éƒ¨' : 'é¸å–é …ç›®'})`; const html = `<!DOCTYPE html><html lang=&quot;zh-Hant&quot;><head><meta charset=&quot;UTF-8&quot;><title>${title}</title><style>body{font-family:sans-serif;margin:20px}table{border-collapse:collapse;width:100%;border:1px solid #ccc;margin-bottom:20px}th,td{border:1px solid #ddd;padding:8px 12px}th{background-color:#f2f2f2}</style></head><body><h1>${title}</h1><p>ç”¢ç”Ÿæ™‚é–“: ${new Date().toLocaleString()}</p>${content}</body></html>`; downloadHtml(html, `report_${mode}_${new Date().toISOString().slice(0, 10)}.html`); }
            function downloadHtml(content, filename) { const blob = new Blob([content], { type: 'text/html;charset=utf-8;' }); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = filename; a.click(); URL.revokeObjectURL(a.href); }
            function exportXlsx(mode) { const tables = Array.from(elements.displayArea.querySelectorAll('.table-wrapper:not([style*=&quot;display: none&quot;]) table')); if (tables.length === 0) { alert('æ²’æœ‰å¯åŒ¯å‡ºçš„è¡¨æ ¼ã€‚'); return; } if (mode === 'selected' && elements.displayArea.querySelectorAll('.row-checkbox:checked').length === 0) { alert('è«‹å…ˆå‹¾é¸è¦åŒ¯å‡ºçš„è³‡æ–™åˆ—ã€‚'); return; } try { const workbook = XLSX.utils.book_new(); tables.forEach((table, i) => { const data = extractTableData(table, { onlySelected: mode === 'selected', includeFilename: true }); if (data.length > 1) { const ws = XLSX.utils.aoa_to_sheet(data); ws['!cols'] = calculateColumnWidths(data); XLSX.utils.book_append_sheet(workbook, ws, `Sheet${i + 1}`); } }); if (workbook.SheetNames.length === 0) { alert('æ²’æœ‰è³‡æ–™å¯ä»¥åŒ¯å‡ºã€‚'); return; } XLSX.writeFile(workbook, `report_${mode}_${new Date().toISOString().slice(0, 10)}.xlsx`); } catch (err) { console.error('åŒ¯å‡º XLSX éŒ¯èª¤:', err); alert('åŒ¯å‡º XLSX æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼š' + err.message); } }
            function exportMergedXlsx() { const tables = Array.from(elements.displayArea.querySelectorAll('.table-wrapper:not([style*=&quot;display: none&quot;]) table')); if (tables.length === 0) { alert('æ²’æœ‰å¯åŒ¯å‡ºçš„è¡¨æ ¼ã€‚'); return; } try { const allData = []; tables.forEach((table, i) => { const data = extractTableData(table, { includeFilename: true }); if (data.length > 1) allData.push(...(i === 0 ? data : data.slice(1))); }); if (allData.length <= 1) { alert('æ²’æœ‰è¶³å¤ çš„è³‡æ–™å¯ä»¥åŒ¯å‡ºã€‚'); return; } const ws = XLSX.utils.aoa_to_sheet(allData); ws['!cols'] = calculateColumnWidths(allData); const workbook = XLSX.utils.book_new(); XLSX.utils.book_append_sheet(workbook, ws, 'Merged Data'); XLSX.writeFile(workbook, `report_merged_${new Date().toISOString().slice(0, 10)}.xlsx`); alert(`æˆåŠŸåˆä½µ ${tables.length} å€‹è¡¨æ ¼ï¼Œå…± ${allData.length - 1} ç­†è³‡æ–™ã€‚`); } catch (err) { console.error('åˆä½µåŒ¯å‡º XLSX éŒ¯èª¤:', err); alert('åˆä½µåŒ¯å‡º XLSX æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼š' + err.message); } }
            function calculateColumnWidths(data) { if (data.length === 0) return []; return data[0].map((_, col) => ({ wch: Math.min(50, Math.max(10, ...data.map(row => row[col] ? String(row[col]).length : 0)) + 2) })); }
            function resetView() { if (!state.originalHtmlString) return; elements.displayArea.innerHTML = state.originalHtmlString; injectCheckboxes(); ['searchInput', 'selectKeywordInput'].forEach(id => elements[id].value = ''); elements.selectKeywordRegex.checked = false; filterTable(); elements.loadStatusMessage.classList.add('hidden'); const hiddenCount = detectHiddenElements(); if (hiddenCount > 0) { elements.loadStatusMessage.textContent = `æ³¨æ„ï¼šå·²é‡è¨­è¡¨æ ¼ï¼Œ${hiddenCount} å€‹éš±è—çš„è¡Œåˆ—å·²é‚„åŸã€‚`; elements.loadStatusMessage.classList.remove('hidden'); elements.showHiddenBtn.classList.remove('hidden'); } updateSelectionInfo(); setViewMode('list'); }
            function resetControls(isNewFile) { if (!isNewFile) return; state.originalHtmlString = ''; ['searchInput', 'selectKeywordInput'].forEach(id => elements[id].value = ''); elements.selectKeywordRegex.checked = false; elements.controlPanel.classList.add('hidden'); updateSelectionInfo(); }
            function updateDropAreaDisplay() { const hasFiles = state.loadedTables > 0; elements.dropArea.classList.toggle('compact', hasFiles); elements.dropAreaInitial.classList.toggle('hidden', hasFiles); elements.dropAreaLoaded.classList.toggle('hidden', !hasFiles); elements.importOptionsContainer.classList.toggle('hidden', hasFiles); if (hasFiles) { elements.fileCount.textContent = state.loadedTables; const names = state.loadedFiles.slice(0, 3).join(', '); const more = state.loadedFiles.length > 3 ? ` åŠå…¶ä»– ${state.loadedFiles.length - 3} å€‹...` : ''; elements.fileNames.textContent = names + more; } }
            function clearAllFiles(silent = false) { if (!silent && !confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰å·²è¼‰å…¥çš„æª”æ¡ˆå—ï¼Ÿ')) return; state.originalHtmlString = ''; state.loadedFiles = []; state.loadedTables = 0; elements.displayArea.innerHTML = ''; elements.fileInput.value = ''; ['specificSheetNameInput', 'specificSheetPositionInput'].forEach(id => elements[id].value = ''); elements.gridScaleSlider.value = 3; updateGridScale(); updateDropAreaDisplay(); resetControls(true); setViewMode('list'); }
            function showControls(hiddenCount) {
                elements.controlPanel.classList.remove('hidden');
                ['selectByKeywordGroup', 'selectByKeywordBtn', 'selectEmptyBtn', 'deleteSelectedBtn', 'invertSelectionBtn', 'exportHtmlBtn', 'selectAllBtn', 'exportSelectedBtn', 'exportXlsxBtn', 'exportSelectedXlsxBtn', 'exportMergedXlsxBtn', 'resetViewBtn', 'tableLevelControls', 'listViewBtn', 'gridViewBtn'].forEach(id => {
                    const el = elements[id];
                    if(el) el.classList.remove('hidden');
                });
                if (hiddenCount > 0) {
                    elements.loadStatusMessage.textContent = `æ³¨æ„ï¼šæª”æ¡ˆä¸­åŒ…å« ${hiddenCount} å€‹è¢«éš±è—çš„è¡Œåˆ—ã€‚`;
                    elements.loadStatusMessage.classList.remove('hidden');
                    elements.showHiddenBtn.classList.remove('hidden');
                }
            }
            function setViewMode(mode) { if (mode === 'grid') { elements.displayArea.classList.remove('list-view'); elements.displayArea.classList.add('grid-view'); elements.gridViewBtn.classList.add('active'); elements.listViewBtn.classList.remove('active'); elements.gridScaleControl.classList.remove('hidden'); } else { elements.displayArea.classList.remove('grid-view'); elements.displayArea.classList.add('list-view'); elements.listViewBtn.classList.add('active'); elements.gridViewBtn.classList.remove('active'); elements.gridScaleControl.classList.add('hidden'); } }
            function updateGridScale() { const columns = elements.gridScaleSlider.value; elements.displayArea.style.setProperty('--grid-columns', columns); }
            function validateFiles(fileList) { if (!fileList || fileList.length === 0) return { valid: false, error: 'æ²’æœ‰é¸æ“‡æª”æ¡ˆ' }; const validFiles = Array.from(fileList).filter(file => CONSTANTS.VALID_FILE_EXTENSIONS.some(ext => file.name.toLowerCase().endsWith(ext))); if (validFiles.length === 0) return { valid: false, error: 'è«‹ä¸Šå‚³ .xls æˆ– .xlsx æ ¼å¼çš„æª”æ¡ˆ' }; return { valid: true, files: validFiles }; }
            function debounce(func, wait) { let timeout; return (...args) => { clearTimeout(timeout); timeout = setTimeout(() => func(...args), wait); }; }
            function handleScroll() { if (window.scrollY > window.innerHeight / 2) { elements.backToTopBtn.classList.add('visible'); } else { elements.backToTopBtn.classList.remove('visible'); } }
            function scrollToTop() { window.scrollTo({ top: 0, behavior: 'smooth' }); }
            
            function handleCardClick(e) {
                const card = e.target.closest('.table-wrapper');
                if (!card) return;

                if (e.target.classList.contains('close-zoom')) {
                    closePreview();
                    return;
                }
                if (e.target.classList.contains('delete-rows-btn')) {
                    deleteSelectedRows(card);
                    return;
                }
                if (e.target.classList.contains('delete-table-btn')) {
                    if (confirm(`ç¢ºå®šè¦æ°¸ä¹…åˆªé™¤æ­¤å·¥ä½œè¡¨ (${card.querySelector('h4').textContent}) å—ï¼Ÿ`)) {
                        closePreview();
                        setTimeout(() => {
                            card.remove();
                            updateFileStateAfterDeletion();
                        }, 300);
                    }
                    return;
                }

                if (elements.displayArea.classList.contains('grid-view') && !card.classList.contains('is-zoomed')) {
                    if (!e.target.matches('input, a, button')) {
                        openPreview(card);
                    }
                }
            }

            function openPreview(card) {
                if (state.zoomedCard) return;
                card.classList.add('is-zoomed');
                state.zoomedCard = card;
                document.body.classList.add('no-scroll');
            }

            function closePreview() {
                if (!state.zoomedCard) return;
                state.zoomedCard.classList.remove('is-zoomed');
                state.zoomedCard = null;
                document.body.classList.remove('no-scroll');
            }

            return { init };
        })();
        ExcelViewer.init();
    </script>
</body>
</html>
                "></iframe>
            </section>

            <section id="tab-code-pane" class="tab-pane doc-page">
                <h1>ğŸ› ï¸ ç¨‹å¼ç¢¼ç¶­è­·èˆ‡è¨»è§£</h1>
                <p>æ­¤é ç±¤åŒ…å«æ­¤å·¥å…·çš„å®Œæ•´åŸå§‹ç¢¼ï¼Œæ–¹ä¾¿æ‚¨æœªä¾†é€²è¡Œæª¢è¦–ã€ä¿®æ”¹æˆ–ç¶­è­·ã€‚</p>

                <h2>ç¨‹å¼ç¢¼çµæ§‹</h2>
                <p>é€™æ˜¯ä¸€å€‹å–®ä¸€ HTML æª”æ¡ˆæ‡‰ç”¨ï¼Œçµæ§‹å¦‚ä¸‹ï¼š</p>
                <ul>
                    <li><code>&lt;head&gt;</code>ï¼š
                        <ul>
                            <li>å¼•å…¥å¤–éƒ¨ <code>xlsx.full.min.js</code> å‡½å¼åº«ï¼Œé€™æ˜¯è®€å– Excel æª”æ¡ˆçš„æ ¸å¿ƒã€‚</li>
                            <li><code>&lt;style&gt;</code> æ¨™ç±¤ï¼šåŒ…å«æ‰€æœ‰çš„ CSS æ¨£å¼ã€‚</li>
                        </ul>
                    </li>
                    <li><code>&lt;body&gt;</code>ï¼š
                        <ul>
                            <li>HTML çµæ§‹ï¼šå®šç¾©äº†ä¸Šå‚³å€åŸŸã€æ§åˆ¶é¢æ¿ã€è¡¨æ ¼é¡¯ç¤ºå€åŸŸç­‰æ‰€æœ‰ä»‹é¢å…ƒç´ ã€‚</li>
                            <li><code>&lt;script&gt;</code> æ¨™ç±¤ï¼š
                                <ul>
                                    <li>ä½¿ç”¨ IIFE (Immediately Invoked Function Expression) æ¨¡å¼ï¼Œå°‡æ‰€æœ‰ç¨‹å¼ç¢¼å°è£åœ¨ <code>ExcelViewer</code> ç‰©ä»¶ä¸­ï¼Œé¿å…æ±¡æŸ“å…¨åŸŸè®Šæ•¸ã€‚</li>
                                    <li><code>ExcelViewer.init()</code>ï¼šç¨‹å¼çš„é€²å…¥é»ï¼Œè² è²¬ç¶å®šæ‰€æœ‰äº‹ä»¶ç›£è½å™¨ã€‚</li>
                                    <li><strong>ç‹€æ…‹ç®¡ç†</strong>ï¼šä½¿ç”¨ <code>state</code> ç‰©ä»¶ä¾†è¿½è¹¤ç›®å‰ç‹€æ…‹ï¼ˆå¦‚æ˜¯å¦è™•ç†ä¸­ã€è¼‰å…¥çš„æª”æ¡ˆåˆ—è¡¨ç­‰ï¼‰ã€‚</li>
                                    <li><strong>DOM å¿«å–</strong>ï¼šä½¿ç”¨ <code>cacheElements()</code> å‡½æ•¸åœ¨å•Ÿå‹•æ™‚å¿«å–æ‰€æœ‰éœ€è¦æ“ä½œçš„ DOM å…ƒç´ ï¼Œæå‡æ•ˆèƒ½ã€‚</li>
                                    <li><strong>ä¸»è¦é‚è¼¯</strong>ï¼š
                                        <ul>
                                            <li><code>processFiles()</code>: è™•ç†æª”æ¡ˆä¸Šå‚³ã€é©—è­‰ã€è®€å–å’Œè§£æçš„æ ¸å¿ƒéåŒæ­¥å‡½æ•¸ã€‚</li>
                                            <li><code>renderTables()</code>: å°‡è§£æå¾Œçš„ HTML è¡¨æ ¼æ¸²æŸ“åˆ°é é¢ä¸Šï¼Œä¸¦å‘¼å« <code>injectCheckboxes()</code> ä¾†æ’å…¥å‹¾é¸æ¡†ã€‚</li>
                                            <li><code>filterTable()</code>: è™•ç†å³æ™‚æœå°‹é‚è¼¯ã€‚</li>
                                            <li><code>selectByKeyword()</code> / <code>selectEmptyRows()</code> ç­‰ï¼šè™•ç†å„ç¨®è³‡æ–™åˆ—å‹¾é¸é‚è¼¯ã€‚</li>
                                            <li><code>exportHtml()</code> / <code>exportXlsx()</code> / <code>exportMergedXlsx()</code>: è™•ç†ä¸åŒé¡å‹çš„åŒ¯å‡ºé‚è¼¯ã€‚</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>

                <h2>å®Œæ•´åŸå§‹ç¢¼</h2>
                <pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;zh-Hant&quot;&gt;
&lt;head&gt;
&lt;!-- 
    ... 
    å®Œæ•´çš„ç¨‹å¼ç¢¼ (HTML, CSS, JS) å¦‚ä¸‹æ‰€åˆ— ...
    ...
--&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;zh-Hant&quot;&gt;
&lt;head&gt;
Â  Â  &lt;meta charset=&quot;UTF-8&quot;&gt;
Â  Â  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
Â  Â  &lt;title&gt;Excel æª¢è¦–å™¨ - å¤šæª”æ¡ˆæ•´åˆå·¥å…·&lt;/title&gt;
Â  Â  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js&quot;&gt;&lt;/script&gt;
Â  Â  &lt;style&gt;
Â  Â  Â  * { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; }

body {
Â  Â  font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial, sans-serif;
Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  min-height: 100vh;
Â  Â  padding: 5px;
}
body.no-scroll {
Â  Â  overflow: hidden;
Â  Â  height: 100vh;
}

.page-container,
.container {
Â  Â  max-width: 1400px;
Â  Â  margin: 0 auto;
Â  Â  background: white;
Â  Â  border-radius: 8px;
Â  Â  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
Â  Â  overflow: hidden;
}

.header,
.page-header {
Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  color: white;
Â  Â  padding: 10px 15px;
Â  Â  text-align: center;
Â  Â  position: relative;
}

.header h1, .page-header h1 {
Â  Â  font-size: 1.4rem;
Â  Â  margin-bottom: 4px;
}
.header p, .page-header p {
Â  Â  opacity: 0.9;
Â  Â  font-size: 0.9rem;
}

.content-area { padding: 10px; }

#drop-area {
Â  Â  border: 3px dashed #667eea;
Â  Â  border-radius: 12px;
Â  Â  padding: 60px 40px; /* é€™è£¡åŠ å¤§å…§è· */
Â  Â  min-height: 320px;Â  Â /* è¨­å®šæœ€å°é«˜åº¦ï¼Œè®“æ‹–æ›³æ¡†è®Šé«˜ */
Â  Â  font-size: 1.2rem;Â  Â /* è®“æ–‡å­—ä¹Ÿæ›´å¤§ */
Â  Â  text-align: center;
Â  Â  background: #f8f9fa;
Â  Â  cursor: pointer;
Â  Â  transition: all 0.3s ease;
Â  Â  margin-bottom: 20px;
Â  Â  position: relative;
Â  Â  display: flex;
Â  Â  flex-direction: column;
Â  Â  justify-content: center;
Â  Â  align-items: center;
}
/* [ CSS ä¿®æ”¹ ] åœ¨ .compact æ¨¡å¼ä¸‹ï¼Œé‡è¨­æœ€å°é«˜åº¦ */
#drop-area.compact { 
    padding: 10px; 
    display: flex; 
    align-items: center; 
    justify-content: space-between; 
    text-align: left; 
    min-height: auto; /* <-- å·²åŠ å…¥æ­¤è¡Œ */
}
#drop-area:hover, #drop-area.highlight {
Â  Â  background: #e9ecef; border-color: #764ba2; transform: translateY(-2px);
}
#drop-area h3 { color: #667eea; margin-bottom: 8px; font-size: 1.1rem; }
#drop-area.compact h3 { margin-bottom: 0; font-size: 1rem; }
#drop-area p { color: #6c757d; margin-bottom: 10px; }
#drop-area.compact p { margin-bottom: 0; font-size: 0.85rem; }
#file-input { display: none; }

.btn-upload {
Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  color: white; border: none; padding: 8px 20px;
Â  Â  border-radius: 8px; font-size: 0.95rem; cursor: pointer; transition: all 0.3s ease;
}
.btn-upload:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2); }

#import-options-container {
Â  Â  background: #f8f9fa; border-radius: 8px; padding: 10px;
Â  Â  margin-bottom: 10px; border: 1px solid #e9ecef;
}
#import-options-container fieldset { border: none; padding: 0; margin: 0; }
#import-options-container legend {
Â  Â  font-weight: 600; color: #495057; padding-bottom: 6px;
Â  Â  margin-bottom: 6px; width: 100%; border-bottom: 1px solid #dee2e6;
Â  Â  font-size: 1rem;
}
.import-option { display: block; margin-bottom: 4px; cursor: pointer; padding: 4px; }
.import-option input[type=&quot;radio&quot;] { margin-right: 6px; accent-color: #667eea; }
.input-group { margin-top: 6px; margin-left: 12px; }
.input-group input[type=&quot;text&quot;] {
Â  Â  padding: 6px 8px; border: 2px solid #dee2e6; border-radius: 6px;
Â  Â  font-size: 0.85rem; transition: border-color 0.3s ease; width: 100%;
}
.input-group input[type=&quot;text&quot;]:focus { outline: none; border-color: #667eea; }

.file-info { display: flex; align-items: center; gap: 8px; flex: 1; }
.file-info-text { flex: 1; }
.file-count {
Â  Â  display: inline-block; background: #667eea; color: white;
Â  Â  padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;
Â  Â  font-weight: 600; margin-left: 6px;
}
.btn-clear {
Â  Â  background: #dc3545; color: white; border: none; padding: 4px 10px;
Â  Â  border-radius: 6px; font-size: 0.8rem; cursor: pointer; transition: all 0.3s ease;
}
.btn-clear:hover { background: #c82333; transform: translateY(-1px); }

.controls { background: #f8f9fa; padding: 10px; border-radius: 8px; margin-bottom: 10px; }
.control-group { margin-bottom: 6px; padding-bottom: 6px; border-bottom: 1px solid #e9ecef; }
.control-group:last-child { margin-bottom: 0; border-bottom: none; padding-bottom: 0; }

.control-group-row {
Â  Â  display: flex; gap: 10px; margin-bottom: 8px; padding-bottom: 8px; border-bottom: 1px solid #e9ecef;
}
.control-group-row &gt; .control-group { flex: 1; margin-bottom: 0; padding-bottom: 0; border-bottom: none; }

.control-group label { display: block; margin-bottom: 4px; font-weight: 600; color: #495057; font-size: 0.95rem;}
.control-group input[type=&quot;text&quot;] {
Â  Â  width: 100%; padding: 8px 10px; border: 2px solid #dee2e6;
Â  Â  border-radius: 8px; font-size: 0.95rem; transition: border-color 0.3s ease;
}
.control-group input[type=&quot;text&quot;]:focus { outline: none; border-color: #667eea; }

.checkbox-label { display: inline-flex; align-items: center; cursor: pointer; font-weight: normal; }
.checkbox-label input[type=&quot;checkbox&quot;] { margin-right: 6px; accent-color: #667eea; cursor: pointer; }
.button-group { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 8px; }
.btn {
Â  Â  padding: 6px 12px; border: none; border-radius: 8px; font-size: 0.9rem;
Â  Â  cursor: pointer; transition: all 0.3s ease; font-weight: 500;
}
.btn:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.12); }
.btn.active { background: #343a40; color: white; box-shadow: inset 0 2px 4px rgba(0,0,0,0.2); }
.btn-primary { background: #667eea; color: white; }
.btn-success { background: #28a745; color: white; }
.btn-warning { background: #ffc107; color: #212529; }
.btn-danger { background: #dc3545; color: white; }
.btn-info { background: #17a2b8; color: white; }
.btn-secondary { background: #6c757d; color: white; }
.hidden { display: none !important; }
.status-message {
Â  Â  background: #fff3cd; border-left: 4px solid #ffc107; padding: 6px;
Â  Â  border-radius: 8px; margin-bottom: 8px; color: #856404;
}
.info-feedback-box { background-color: #e6f7ff; border: 1px solid #b3e0ff;
Â  Â  border-radius: 4px; padding: 6px 8px; margin-top: 8px;}
.info-feedback-box h5 { margin: 0 0 4px 0; color: #004085; font-size: 0.85rem;}
.info-feedback-box p { font-size: 0.75rem; color: #0056b3; margin: 0; max-height: 60px; overflow-y: auto; }

.table-wrapper {
Â  Â  border: 1px solid #dee2e6; border-radius: 8px;
Â  Â  overflow: hidden; background: #fff;
Â  Â  display: flex; flex-direction: column;
Â  Â  box-shadow: 0 1px 6px rgba(0,0,0,0.06);
}
.table-wrapper:hover { box-shadow: 0 2px 12px rgba(0,0,0,0.10);}
.table-header {
Â  Â  display: flex; align-items: center; gap: 6px; padding: 6px 10px;
Â  Â  background-color: #f8f9fa; border-bottom: 1px solid #dee2e6;
Â  Â  flex-shrink: 0;
}
.table-header input[type=&quot;checkbox&quot;] { width: 16px; height: 16px; cursor: pointer; accent-color: #667eea;}
.table-header h4 {
Â  Â  margin: 0; font-size: 0.95rem; font-weight: 600; color: #495057;
Â  Â  white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex-grow: 1;
}
.table-content { flex-grow: 1; overflow: auto; min-height: 0; padding: 4px;}
#excel-display-area.list-view .table-wrapper { margin-bottom: 8px;}
#excel-display-area.grid-view { display: grid; grid-template-columns: repeat(var(--grid-columns, 3), 1fr); gap: 10px;}
#excel-display-area.grid-view .table-wrapper { cursor: pointer; max-height: 200px;}
#excel-display-area.grid-view table th { position: static; }
#grid-scale-control { display: flex; align-items: center; gap: 6px; margin-top: 6px;}
#grid-scale-control label { margin-bottom: 0; white-space: nowrap; }
#grid-scale-slider { width: 100%; accent-color: #667eea;}
/* å°ˆæ³¨æ¨¡å¼ */
#excel-display-area .table-wrapper.is-zoomed {
Â  Â  position: fixed;
Â  Â  top: 0; left: 0; right: 0; bottom: 0;
Â  Â  width: 100vw; height: 100vh;
Â  Â  z-index: 9999; border-radius: 0; border: none;
Â  Â  cursor: default; display: flex; flex-direction: column;
Â  Â  margin: 0; max-width: none; max-height: none; background: white;
Â  Â  box-shadow: none;
}
#excel-display-area .table-wrapper.is-zoomed .table-header {
Â  Â  justify-content: space-between; flex-shrink: 0;
Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  color: white; border-bottom: none;
}
#excel-display-area .table-wrapper.is-zoomed .table-header h4 { color: white; }
#excel-display-area .table-wrapper.is-zoomed .header-actions { display: flex; }
#excel-display-area .table-wrapper.is-zoomed .table-content { flex: 1; min-height: 0; overflow: auto; -webkit-overflow-scrolling: touch; height: 100%;}
#excel-display-area .table-wrapper.is-zoomed .close-zoom { display: block; color: white;}
.header-actions { display: none; align-items: center; gap: 6px; }
.btn-sm { padding: 2px 6px; font-size: 0.8rem;}
.close-zoom { display: none; font-size: 1.3rem; font-weight: bold; line-height: 1; padding: 0 10px; cursor: pointer; border: none; background: none;}

table { width: 100%; border-collapse: collapse; }
table thead { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;}
table th { padding: 6px; text-align: left; font-weight: 600; position: sticky; top: 0; z-index: 1;}
table td { padding: 6px; border-bottom: 1px solid #dee2e6; }
table tbody tr:hover { background: #f8f9fa; }
.checkbox-cell { width: 32px; text-align: center; }
.checkbox-cell input[type=&quot;checkbox&quot;] { cursor: pointer; width: 16px; height: 16px; accent-color: #667eea;}
.row-hidden-search { display: none; }

#back-to-top-btn { position: fixed; bottom: 10px; right: 10px; width: 36px; height: 36px;
Â  Â  border-radius: 50%; background: #667eea; color: white; border: none;
Â  Â  font-size: 18px; cursor: pointer; display: flex; align-items: center;
Â  Â  justify-content: center; box-shadow: 0 2px 6px rgba(102, 126, 234, 0.2);
Â  Â  opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s, transform 0.3s; z-index: 1000;
}
#back-to-top-btn.visible { opacity: 1; visibility: visible; }
#back-to-top-btn:hover { transform: translateY(-2px); background: #5a6fd8; }

body::-webkit-scrollbar, .table-content::-webkit-scrollbar {
Â  Â  width: 8px; height: 8px;
}
body::-webkit-scrollbar-track, .table-content::-webkit-scrollbar-track {
Â  Â  background: #f1f1f1;
}
body::-webkit-scrollbar-thumb, .table-content::-webkit-scrollbar-thumb {
Â  Â  background-color: #888; border-radius: 6px; border: 2px solid #f1f1f1;
}
body::-webkit-scrollbar-thumb:hover, .table-content::-webkit-scrollbar-thumb:hover {
Â  Â  background-color: #555;
}

@media (max-width: 992px) {
Â  Â  .control-group-row { flex-direction: column; gap: 0; }
}
@media (max-width: 768px) {
Â  Â  body { padding: 3px;}
Â  Â  .content-area { padding: 6px;}
Â  Â  .header h1, .page-header h1 { font-size: 1.05rem;}
Â  Â  #drop-area { padding: 12px 6px;}
Â  Â  table th, table td { padding: 4px;}
Â  Â  #back-to-top-btn { bottom: 6px; right: 6px; width: 28px; height: 28px; font-size: 14px;}
}
.loading { text-align: center; padding: 20px; color: #667eea; font-size: 1rem;}
.loading::after { content: '...'; animation: dots 1.5s steps(4, end) infinite; }
@keyframes dots { 0%, 20% { content: '.'; } 40% { content: '..'; } 60%, 100% { content: '...'; } }

body.no-scroll .controls { display: none !important; }

* {
Â  Â  -webkit-font-smoothing: antialiased;
Â  Â  -moz-osx-font-smoothing: grayscale;
}

Â  Â  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

tr&gt;
Â  Â  Â  Â  &lt;div id=&quot;import-options-container&quot;&gt;
Â  Â  Â  Â  Â  Â  Â  Â  &lt;fieldset&gt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &lt;legend&gt;âš™ï¸ æ­¥é©Ÿä¸€ï¼šé¸æ“‡åŒ¯å…¥æ–¹å¼&lt;/legend&gt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &lt;label class=&quot;import-option&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;import-mode&quot; value=&quot;all&quot;&gt; åŒ¯å…¥æ‰€æœ‰å·¥ä½œè¡¨&lt;/label&gt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &lt;label class=&quot;import-option&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;import-mode&quot; value=&quot;first&quot; checked&gt; åƒ…åŒ¯å…¥ç¬¬ä¸€å¼µå·¥ä½œè¡¨&lt;/label&gt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &lt;label class=&quot;import-option&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;import-mode&quot; value=&quot;position&quot;&gt; åŒ¯å…¥æŒ‡å®šä½ç½®&lt;/label&gt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &lt;div id=&quot;specific-sheet-position-group&quot; class=&quot;input-group hidden&quot;&gt;&lt;input type=&quot;text&quot; id=&quot;specific-sheet-position-input&quot; placeholder=&quot;ä¾‹å¦‚: 1, 3, 5-7&quot;&gt;&lt;/div&gt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &lt;label class=&quot;import-option&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;import-mode&quot; value=&quot;specific&quot;&gt; åŒ¯å…¥æŒ‡å®šåç¨±&lt;/label&gt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &lt;div id=&quot;specific-sheet-name-group&quot; class=&quot;input-group hidden&quot;&gt;&lt;input type=&quot;text&quot; id=&quot;specific-sheet-name-input&quot; placeholder=&quot;è«‹è¼¸å…¥åç¨±é—œéµå­—&quot;&gt;&lt;/div&gt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &lt;label class=&quot;import-option&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;import-mode&quot; value=&quot;manual&quot;&gt; é€ä¸€æª”æ¡ˆæ‰‹å‹•æ±ºå®š&lt;/label&gt;
Â  Â  Â  Â  Â  Â  Â  Â  &lt;/fieldset&gt;
Â  Â  Â  Â  Â  Â  &lt;/div&gt;

Â  Â  Â  Â  Â  Â  &lt;div id=&quot;drop-area&quot;&gt;
Â  Â  Â  Â  Â  Â  Â  Â  &lt;input type=&quot;file&quot; id=&quot;file-input&quot; accept=&quot;.xls,.xlsx&quot; multiple&gt;
Â  Â  Â  Â  Â  Â  Â  Â  &lt;div id=&quot;drop-area-initial&quot;&gt;&lt;h3&gt;ğŸ“ æ­¥é©ŸäºŒï¼šæ‹–æ”¾æª”æ¡ˆåˆ°æ­¤è™•&lt;/h3&gt;&lt;p&gt;æˆ–é»æ“Šä¸‹æ–¹æŒ‰éˆ•é¸æ“‡æª”æ¡ˆ&lt;/p&gt;&lt;button class=&quot;btn-upload&quot;&gt;é¸æ“‡ Excel æª”æ¡ˆ&lt;/button&gt;&lt;/div&gt;
Â  Â  Â  Â  Â  Â  Â  Â  &lt;div id=&quot;drop-area-loaded&quot; class=&quot;hidden&quot;&gt;&lt;div class=&quot;file-info&quot;&gt;&lt;div class=&quot;file-info-text&quot;&gt;&lt;h3&gt;ğŸ“Š å·²è¼‰å…¥æª”æ¡ˆ &lt;span class=&quot;file-count&quot; id=&quot;file-count&quot;&gt;0&lt;/span&gt;&lt;/h3&gt;&lt;p id=&quot;file-names&quot;&gt;-&lt;/p&gt;&lt;/div&gt;&lt;button class=&quot;btn-clear&quot; id=&quot;clear-files-btn&quot;&gt;ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰æª”æ¡ˆ&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;
Â  Â  Â  Â  Â  Â  &lt;/div&gt;

Â  Â  Â  Â  Â  Â  &lt;div class=&quot;controls hidden&quot; id=&quot;control-panel&quot;&gt;
Â  Â  Â  Â  Â  Â  Â  Â  &lt;div class=&quot;control-group-row&quot;&gt;
Â  Â  Â  Â  _B... 1000 lines more ..._
&lt;/html&gt;
                </code></pre>
            </section>
        </main>
    </div>

    <script>
        // --- é ç±¤åˆ‡æ›é‚è¼¯ ---
        document.addEventListener('DOMContentLoaded', () => {
            const tabContainer = document.querySelector('.tab-container');
            const tabBtns = tabContainer.querySelectorAll('.tab-btn');
            const tabPanes = tabContainer.querySelectorAll('.tab-pane');

            tabContainer.addEventListener('click', (e) => {
                const clickedBtn = e.target.closest('.tab-btn');
                if (!clickedBtn) return;

                const tabId = clickedBtn.dataset.tab;
                const targetPane = document.getElementById(tabId);

                if (targetPane) {
                    // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•å’Œé¢æ¿çš„ active ç‹€æ…‹
                    tabBtns.forEach(btn => btn.classList.remove('active'));
                    tabPanes.forEach(pane => pane.classList.remove('active'));

                    // ç‚ºé»æ“Šçš„æŒ‰éˆ•å’Œå°æ‡‰çš„é¢æ¿æ·»åŠ  active ç‹€æ…‹
                    clickedBtn.classList.add('active');
                    targetPane.classList.add('active');
                }
            });
        });
    </script>

</body>
</html>
